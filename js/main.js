const title="@Yhsanave",titlePalettes=[["#e28c00","#e28c00","#eccd00","#eccd00","#ffffff","#62aedc","#62aedc","#203856","#203856"]],titlePalette=_.sample(titlePalettes),characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()-=+[]\\/:<>;{}|~?",randChar=()=>characters.charAt(Math.floor(rand(characters.length))),links=[{id:"discord",href:"https://discord.com/users/195694396115648512",text:["Discord"]},{id:"twitter",href:"https://twitter.yhsanave.me",text:["Twitter"]},{id:"youtube",href:"https://youtube.yhsanave.me/",text:["You","Tube"]},{id:"anilist",href:"https://anilist.yhsanave.me/",text:["Ani","List"]},{id:"libib",href:"https://yhsanave.libib.com/",text:["Manga"]},{id:"steam",href:"https://steamcommunity.com/id/yhsanave/",text:["Steam"]},{id:"github",href:"https://github.com/yhsanave",text:["Github"]},{id:"mail",href:"mailto:yhsanave@yhsanave.me",text:["Email"]},{id:"venmo",href:"https://venmo.yhsanave.me/",text:["Venmo"]},{id:"paypal",href:"https://paypal.yhsanave.me/",text:["Pay","Pal"]},{id:"mastodon",href:"https://mastodon.yhsanave.me/",text:["Mastodon"]},{id:"tumblr",href:"https://tumblr.yhsanave.me/",text:["Tumblr"]},{id:"soundcloud",href:"https://soundcloud.yhsanave.me/",text:["SoundCloud"]},{id:"osu",href:"https://osu.ppy.sh/users/7559714",text:["osu!"]},{id:"prsk",copyText:"367762770000629763",text:["PRSK:","3677","62770","0006","29763"]},{id:"switch",copyText:"SW-0834-7237-5116",text:["Switch:","SW-0834-7237-5116"]}],linkLength=t=>t.text.join("").length,funcChars=[{char:"X",func:()=>clearFuncEffects()},{char:"@",func:()=>applyWrapperBackground("@","linear-gradient(80deg, #40e0d0, #ff8c00, #ff0080, #ff8c00, #40e0d0)")},{char:"$",func:()=>applyWrapperBackground("$","linear-gradient(80deg, #00ff00, #00ffff, #0000ff, #00ffff, #00ff00)")},{char:"^",func:()=>applyWrapperBackground("^","linear-gradient(80deg, #e28c00, #eccd00, #ffffff, #62aedc, #203856, #62aedc, #ffffff, #eccd00, #e28c00)")},{char:"|",func:()=>applyWrapperBackground("|","linear-gradient(80deg, rgba(25,25,25,1) 10%, rgba(0,255,0,1) 85%, rgba(25,25,25,1) 90%)")},{char:"&",func:()=>toggleCharColors("&",["#e28c00","#eccd00","#ffffff","#62aedc","#203856"])},{char:"%",func:()=>toggleCharColors("%",["#6B26D9","#246EB9","#4CB944","#FFB30F","#DB222A"])},{char:"V",func:()=>rainFall("V","#FFFFFF","#0044FF","#000044")},{char:"#",func:()=>rainFall("#","#00FF00","#00DD00","#001100")},{char:"*",func:()=>shatter()},{char:"+",func:()=>twinkle()},{char:"a",func:()=>apple()}],funcState={background:"",text:"",textColors:[],shatter:!1,twinkle:!1,rain:"",rainColors:{head:"",tail:"",bg:""},apple:!1},rainFrequency=250,rainSpeed=75,rainWorker=new Worker("js/rainWorker.js");var rainInterval;rainWorker.onmessage=applyRainDrop,$(":root").css("--rain-speed",rainSpeed+"ms");const minRows=links.length+2,minColumns=Math.max(...links.map(t=>linkLength(t)))+1,magicGrid={rows:minRows,columns:minColumns},mutationFrequency=($(":root").css("--ideal-rows",Math.floor(1.5*minRows)),$(":root").css("--min-columns",minColumns),100),mutationFactor=.02,getMutations=()=>Math.floor(magicGrid.rows*magicGrid.columns*mutationFactor),updateInterval=setInterval(()=>mutate(getMutations()),mutationFrequency),sleep=a=>new Promise(t=>setTimeout(t,a)),rand=(t,a=0)=>Math.random()*(t-a)+a,spanify=t=>Array.from(t).map(t=>$("<span>").text(t));function buildLink(r,n,i){let c=$(`<a id="link-${r.id}" class="magic-link"></a>`);return r.href&&c.prop({href:r.href,target:"_blank"}),r.copyText&&(c.click(()=>navigator.clipboard.writeText(r.copyText)),c.prop({title:"Click to Copy"})),r.text.forEach((t,e)=>{spanify(t).forEach((t,a)=>{c.append($(t).addClass("char link-char sublink-"+e).css({"--row":n,"--col":i+a+r.text.slice(0,e).join("").length}).prop({"data-row":n,"data-col":i}).hide())})}),c}function buildGrid(){let n=$("#magicWrapper"),i=(magicGrid.rows=Math.max(Math.floor(n.height()/$("#scaleChar").height())-1,minRows),magicGrid.columns=Math.max(Math.floor(n.width()/$("#scaleChar").width())-1,minColumns),n.css({"--rows":magicGrid.rows,"--columns":magicGrid.columns}),magicGrid.rows/links.length),c={1:{start:1,end:title.length+1}};links.forEach((t,a)=>{var a=Math.ceil(i*(a+1)),e=Math.floor(rand(magicGrid.columns-linkLength(t)-1)+1),r=buildLink(t,a,e);n.append(r),c[a]={start:e,end:e+linkLength(t)}});for(let a=1;a<=magicGrid.rows;a++)for(let t=1;t<=magicGrid.columns;t++)t>=c[a]?.start&&t<c[a]?.end?t=c[a]?.end-1:n.append($(`<span class='char magic-char' data-row="${a}" data-col="${t}">${randChar()}</span>`).css({"--row":a,"--col":t}).hide());let e=_.sampleSize($(".magic-char"),funcChars.length);funcChars.forEach((t,a)=>{$(e[a]).removeClass("magic-char").addClass("func-char").text(t.char).on("click",t.func)})}function mutate(t){funcState.twinkle&&(t=Math.floor(t/5)),_.sampleSize($(".magic-char"),t).forEach(t=>{$(t).text(randChar()),funcState.text&&$(t).css("color",_.sample(funcState.textColors)),funcState.twinkle&&($(t).css({color:"#fff",transition:"color 0.1s"}),setTimeout(()=>{$(t).css({color:"",transition:""})},100))})}async function animateIn(){await sleep(1e3),await animateTitleIn(),await sleep(500),$(".cursor").hide(),await animateMagicTextIn(magicGrid.rows*magicGrid.columns/100,1e3)}async function animateTitleIn(){for(let t=0;t<title.length;t++){var a=$(`<span id="title_${t}">${title[t]}</span>`).css({color:titlePalette[t],"--i":t});$(".cursor").before(a),await sleep(50)}}async function animateMagicTextIn(a,t){var e=_.shuffle($(".char")),t=Math.ceil(t/a),r=Math.floor(e.length/t);for(let t=0;t<e.length;t++)$(e[t]).show(),t%r==0&&await sleep(a)}function resize(){clearFuncEffects(["shatter"]),$(".char").remove(),$(".magic-link").remove(),buildGrid(),$(".char").show()}const shatterOptions={translate:{min:-20,max:20},rotate:{min:-1,max:1},rotateAngle:{min:-45,max:45}};function applyShatter(){var t=$(".shatter");Array.from(t).forEach(t=>{$(t).setShatterVars(...getShatterVars())})}function getShatterVars(){return[rand(shatterOptions.translate.max,shatterOptions.translate.min),rand(shatterOptions.translate.max,shatterOptions.translate.min),rand(shatterOptions.translate.max,shatterOptions.translate.min),rand(shatterOptions.rotate.max,shatterOptions.rotate.min),rand(shatterOptions.rotate.max,shatterOptions.rotate.min),rand(shatterOptions.rotate.max,shatterOptions.rotate.min),rand(shatterOptions.rotateAngle.max,shatterOptions.rotateAngle.min)]}function clearFuncEffects(t=["background","text","shatter","twinkle","rain","apple"]){var a;t.includes("background")&&((a=$(".magic-wrapper")).toggleClass("bg-text bg-gradient-flow",!1),a.css("background",""),funcState.background=""),t.includes("text")&&($(".magic-char").css("color",""),funcState.text="",funcState.textColors=[]),t.includes("shatter")&&($(".shatter").removeClass("shatter"),funcState.shatter=!1),t.includes("twinkle")&&($(".magic-wrapper").removeClass("twinkle"),funcState.twinkle=!1),t.includes("rain")&&($(".rain").removeClass("rain"),$(".drop").removeClass("drop"),clearInterval(rainInterval),funcState.rain="",funcState.rainColors={head:"",tail:"",bg:""}),t.includes("apple")&&($(".magic-wrapper").removeClass("apple"),funcState.apple=!1)}function applyWrapperBackground(t,a){var e,r=funcState.background===t;r?clearFuncEffects(["background"]):(clearFuncEffects(["text","rain","apple"]),(e=$(".magic-wrapper")).toggleClass("bg-text bg-gradient-flow",!r),e.css("background",r?"none":a),funcState.background=r?"":t)}function toggleCharColors(t,a){funcState.text===t?clearFuncEffects(["text"]):(clearFuncEffects(["background","twinkle","rain","apple"]),Array.from($(".magic-char")).forEach(t=>{$(t).css("color",_.sample(a))}),funcState.text=t,funcState.textColors=a)}function shatter(){$(".magic-wrapper").toggleClass("shake",!funcState.shatter),setTimeout(()=>{$(".magic-wrapper").removeClass("shake")},800),$(".char").toggleClass("shatter",!funcState.shatter),funcState.shatter=!funcState.shatter,applyShatter()}function twinkle(){funcState.twinkle?clearFuncEffects(["twinkle"]):(clearFuncEffects(["text","rain","apple"]),funcState.twinkle=!funcState.twinkle,$(".magic-wrapper").toggleClass("twinkle",funcState.twinkle))}function rainFall(t,a,e,r){var n=funcState.rain!==t;n?(clearFuncEffects(["background","text","twinkle","apple"]),clearInterval(rainInterval),$(":root").css({"--drop-head":a,"--drop-tail":e,"--drop-bg":r}),$(".magic-wrapper").toggleClass("rain",n),rainInterval=setInterval(spawnRainDrop,rainFrequency),funcState.rain=t):clearFuncEffects(["rain"])}function spawnRainDrop(){rainWorker.postMessage({rows:magicGrid.rows,col:Math.floor(rand(magicGrid.columns,1)),speed:rainSpeed})}function applyRainDrop(a){if(funcState.rain){let t=$(`.magic-char[data-row=${a.data.row}][data-col=${a.data.col}]`).addClass("drop");setTimeout(()=>$(t).removeClass("drop"),1e3)}}function apple(){funcState.apple?clearFuncEffects(["apple"]):(clearFuncEffects(["background","text","twinkle","rain"]),$(".magic-wrapper").addClass("apple bg-text"),funcState.apple=!0)}async function main(){buildGrid(),await animateIn()}$.fn.setShatterVars=function(t=0,a=0,e=0,r=0,n=0,i=0,c=0){$(this).css({"--tx":t+"px","--ty":a+"px","--tz":e+"px","--rx":""+r,"--ry":""+n,"--rz":""+i,"--ra":c+"deg"})},$(window).on("resize",_.debounce(resize,50)),$(document).ready(main);